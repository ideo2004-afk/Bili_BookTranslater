# Bili (AI 雙語電子書製作工具)

這是一個利用 AI (ChatGPT, Gemini, Ollama 等) 來協助翻譯 EPUB/TXT/SRT 電子書與字幕的工具。專為製作高品質的雙語閱讀材料而設計，特別針對繁體中文語境進行了優化。

---

## ✨ 主要功能

*   **圖形化介面 (GUI)**：提供直覺的操作介面，支援拖放檔案、進度條顯示與即時日誌。
*   **多模型支援**：
    *   **雲端模型**：支援 Google Gemini (Flash/Pro) 與 OpenAI (GPT-4o/mini)。
    *   **本地模型**：支援 Ollama (Llama 3, Qwen 2.5, Gemma 2 等)，完全隱私且免費。
*   **智慧術語表 (Glossary)**：
    *   程式會自動提取並維護書中的人名、地名等專有名詞，確保整本書的翻譯一致性。
*   **斷點續傳 (Resume)**：
    *   翻譯到一半出錯或想暫停？隨時可以從中斷點繼續，不會浪費已翻譯的進度與 Token。
*   **並行處理**：支援多執行緒並行翻譯，大幅提升速度。

---

## 🚀 快速開始 (一鍵安裝與執行)

我們提供了自動化腳本，讓您無需懂程式碼也能輕鬆使用。

### macOS 使用者 (推薦)

1.  **安裝環境** (只需執行一次)：
    *   雙擊 `install.command`。腳本會自動建立環境並安裝必要套件。
2.  **啟動程式**：
    *   雙擊 `run_gui.command` 即可開啟介面。

### Windows 使用者

1.  **安裝環境** (只需執行一次)：
    *   雙擊 `install.bat`。
2.  **啟動程式**：
    *   雙擊 `run_gui.bat` 即可開啟介面。

---

## 📖 使用教學

1.  **設定 API Key**：
    *   開啟程式後，點擊左側「設定」圖示。
    *   選擇模型平台 (`gemini`, `chatgptapi`, `ollama`)。
    *   填入 API Key (Ollama 留空即可)。
2.  **選擇翻譯風格 (Prompt)**：
    *   程式內建三種精心調教的 Prompt，請依需求選擇：
        *   **繁體中文 (預設)**：`prompt_繁中` - 專為台灣繁體中文使用者設計，強調流暢度與在地化用詞。
        *   **通用翻譯**：`prompt_通用` - 適用於翻譯成其他語言，風格較為中性平實。
        *   **學術論文**：`prompt_學術` - 針對學術文件優化，保留專業術語的精確性，語氣正式。
3.  **加入書籍與開始**：
    *   將檔案 (`.epub`, `.txt`) 拖入視窗，點擊「開始翻譯」。

---

## ⚙️ 關於進階參數

為了確保翻譯品質與穩定性，部分參數由程式自動管理，不建議使用者手動調整：

*   **Accumulated Num (批次處理量)**：
    *   程式會自動根據所選模型調整每次傳送給 AI 的文字量，以達到最佳速度與品質平衡。
*   **Request Interval (請求間隔)**：
    *   程式固定設有安全間隔時間，防止因請求過快而導致 API 封鎖 (Rate Limit)，確保長時間翻譯任務的穩定性。
*   **Context (上下文感知)**：
    *   *註：由於實務上開啟上下文會導致大量 Token 消耗且容易引發模型幻覺，目前版本已預設關閉並移除此選項，以確保翻譯的準確度。*

---

## 🛠️ 常見問題 (FAQ)

**Q: 翻譯到一半程式當掉怎麼辦？**
A: 直接重新啟動程式，再次點擊該書籍並按「開始翻譯」。程式會自動偵測並詢問是否從中斷點續傳 (Resume)，選擇「是」即可完美銜接。

**Q: 為什麼本地 Ollama 翻譯比較慢？**
A: 本地模型的速度完全取決於您的電腦顯卡 (GPU) 效能。若速度過慢，建議改用 Gemini Flash 等雲端模型，既便宜又快速。

**Q: 翻譯出來的繁體中文怪怪的？**
A: 請確認您在設定中選擇了 `prompt_繁中`。此外，不同模型 (如 GPT-4 與 Llama 3) 的中文能力本身就有差異，建議嘗試更換模型。

---

## ⚠️ 免責聲明

本工具僅供個人學習與研究使用。請勿用於翻譯有版權爭議的書籍並進行散布。使用者需自行承擔使用本工具所產生的一切法律責任。

---

## 🔧 實用小工具 (進階)

本專案附帶了一些實用的命令列工具，供進階使用者使用：

### 雙語轉單語工具 (`2single.py`)
如果您已經製作了雙語對照的 EPUB 電子書，但想要一個「純中文」的乾淨閱讀版本，可以使用此腳本快速轉換。

*   **功能**：自動辨識並移除雙語 EPUB 中的英文段落，只保留中文內容。
*   **用法**：
    1. 開啟終端機 (Terminal)。
    2. 執行指令：
       ```bash
       python 2single.py "您的電子書.epub"
       ```
    3. 程式會自動產生一個檔名結尾為 `_Single.epub` 的純中文版本。
